# OneTabPlus 同步策略 (v1.4.7)

本文档详细介绍了 OneTabPlus 扩展中的数据同步策略，该策略旨在提供最佳的多设备体验，同时确保数据安全和一致性。在 v1.4.7 版本中，我们简化了同步逻辑，只保留手动同步功能，提高了稳定性和可靠性。

## 同步策略概述

OneTabPlus 采用**智能增量合并**策略进行数据同步，这是增量同步和智能合并的结合。这种策略既能保留用户数据，又能提供良好的用户体验。

### 核心原则

1. **数据安全第一**：不会丢失用户数据
2. **用户控制**：用户可以选择同步策略
3. **透明性**：清晰显示同步状态和冲突
4. **效率**：只同步必要的数据，减少网络使用

## 手动同步模式

从 v1.4.7 版本开始，OneTabPlus 采用了简化的手动同步模式，这意味着：

1. **用户控制**：用户可以通过点击同步按钮手动触发同步操作，完全控制何时同步数据。

2. **更高的可靠性**：简化的同步逻辑减少了复杂性，提高了系统的可靠性和稳定性。

3. **清晰的同步状态**：同步按钮旁边显示上次同步时间，让用户清楚地知道数据的时效性。

### 同步流程

手动同步的流程如下：

1. **用户触发**：用户点击界面上的同步按钮，触发同步操作。

2. **上传本地数据**：首先将本地数据上传到云端，包括标签组和设置。

3. **下载云端数据**：然后从云端下载最新数据。

4. **智能合并**：使用智能合并算法合并本地和云端数据，确保不会丢失任何数据。

5. **更新本地存储**：将合并后的数据保存到本地存储。

6. **更新界面**：更新界面显示最新的数据和同步状态。

### 数据存储格式

OneTabPlus 使用 JSONB 格式存储标签数据，这种格式具有以下优势：

1. **灵活性**：JSONB 格式可以存储复杂的嵌套数据结构，非常适合标签组和标签数据。

2. **效率**：JSONB 格式可以高效地存储和检索数据，减少了数据库查询的复杂性。

3. **兼容性**：JSONB 格式与 JavaScript 对象兼容，便于前端处理。

## 同步策略选项

用户可以在设置中选择以下同步策略：

1. **云端优先**：优先使用云端数据，适合希望所有设备保持一致的用户。

2. **本地优先**：优先使用本地数据，适合希望保留本地更改的用户。

3. **询问**：当发生冲突时询问用户如何处理，适合希望完全控制同步过程的用户。

## 结论

OneTabPlus 的手动同步模式提供了简单、可靠的数据同步方式，让用户可以完全控制何时同步数据，同时确保数据安全和一致性。通过智能合并算法，OneTabPlus 可以有效地处理多设备之间的数据同步，提供最佳的用户体验。

# 清理重复标签功能

## 功能概述

"清理重复标签"功能允许用户一键清理所有标签组中的重复标签页。重复标签页是指URL相同的标签页，清理后只保留每个URL的一个标签页实例，从而使标签组更加整洁和高效。

## 使用方法

1. 在标签管理器主界面顶部工具栏中找到"清理重复标签"按钮
2. 点击该按钮，会弹出确认对话框
3. 点击"确认清理"按钮执行清理操作
4. 清理完成后，会显示清理结果，包括清理的标签页数量

## 清理规则

- 系统会扫描所有标签组中的标签页，识别URL相同的标签页
- 对于每个URL，系统会保留最新访问的一个标签页（基于lastAccessed时间）
- 其他重复的标签页将被删除
- 如果清理后某个标签组没有标签页，该标签组会被自动删除（锁定的标签组除外）

## 注意事项

- 清理操作不可撤销，请谨慎使用
- 清理操作会同步到云端（如果已登录）
- 锁定的标签组中的重复标签也会被清理
- 特殊URL（如loading://开头的URL）会进行额外的标题比较，避免误删

## 技术实现

### 核心算法

清理重复标签的核心算法如下：

1. 获取所有标签组
2. 创建URL映射，记录每个URL对应的标签页
3. 扫描所有标签页，按URL分组
4. 对于每个URL组：
   - 如果只有一个标签页，保持不变
   - 如果有多个标签页，按lastAccessed时间排序，保留最新的一个，删除其余的
5. 处理空标签组（清理后没有标签页的标签组）
6. 保存更新后的标签组
7. 同步到云端（如果已登录）

### 数据流

1. 用户点击"清理重复标签"按钮
2. 显示确认对话框
3. 用户确认后，dispatch `cleanDuplicateTabs` action
4. Action 执行清理逻辑
5. 更新本地存储
6. 同步到云端
7. 返回清理结果
8. 更新UI显示清理结果

### 边界情况处理

- **空标签组处理**：如果清理后某个标签组没有标签页，自动删除该标签组（非锁定状态）
- **锁定标签组处理**：锁定的标签组中的重复标签也会被清理，但如果清理后标签组为空，不会删除锁定的标签组
- **特殊URL处理**：对于`loading://`开头的特殊URL，按照标题进行额外比较，避免误删
- **错误处理**：添加适当的错误处理，确保即使清理过程中出现错误，也不会影响用户数据

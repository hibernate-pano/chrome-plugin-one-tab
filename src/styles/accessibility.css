/* ==========================================
   ğŸŒ å¯è®¿é—®æ€§å¢å¼ºæ ·å¼
   ç¬¦åˆ WCAG 2.1 AA æ ‡å‡†
   ========================================== */

/*
 * å¯è®¿é—®æ€§åŸåˆ™ï¼š
 * 1. å¯¹æ¯”åº¦æ¯”ä¾‹è‡³å°‘ 4.5:1 (AAçº§) æˆ– 7:1 (AAAçº§)
 * 2. æœ€å°è§¦æ‘¸ç›®æ ‡ 44x44px
 * 3. é”®ç›˜å¯¼èˆªæ”¯æŒ
 * 4. å±å¹•é˜…è¯»å™¨å‹å¥½
 * 5. å‡å°‘åŠ¨ç”»åå¥½æ”¯æŒ
 */

/* ==========================================
   ç„¦ç‚¹ç®¡ç†
   ========================================== */

/* ç§»é™¤é»˜è®¤ç„¦ç‚¹æ ·å¼ */
*:focus {
  outline: none;
}

/* è‡ªå®šä¹‰ç„¦ç‚¹æŒ‡ç¤ºå™¨ */
*:focus-visible {
  outline: 2px solid var(--color-accent, #0D9488);
  outline-offset: 2px;
  border-radius: 4px;
}

/* é«˜å¯¹æ¯”åº¦ç„¦ç‚¹æŒ‡ç¤ºå™¨ */
@media (prefers-contrast: high) {
  *:focus-visible {
    outline: 3px solid var(--color-text-primary, #134E4A);
    outline-offset: 3px;
    background-color: var(--color-bg-elevated, #FFFFFF);
  }
}

/* è·³è¿‡é“¾æ¥ */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: var(--color-accent, #0D9488);
  color: white;
  padding: 8px 16px;
  text-decoration: none;
  border-radius: 4px;
  font-weight: 600;
  z-index: 1000;
  transition: top 0.3s;
}

.skip-link:focus {
  top: 6px;
}

/* ==========================================
   è§¦æ‘¸ç›®æ ‡ä¼˜åŒ–
   ========================================== */

/* ç¡®ä¿æ‰€æœ‰äº¤äº’å…ƒç´ è‡³å°‘ 44x44px */
button,
.btn,
.btn-icon,
input[type="button"],
input[type="submit"],
input[type="reset"],
a[role="button"],
[role="button"],
[tabindex="0"] {
  min-height: 44px;
  min-width: 44px;
}

/* ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ– */
@media (max-width: 768px) {
  .tab-item,
  .dropdown-item,
  .menu-item {
    min-height: 48px;
    padding: 12px 16px;
  }

  .btn-icon {
    min-height: 48px;
    min-width: 48px;
  }
}

/* ==========================================
   æ–‡æœ¬å¯è¯»æ€§
   ========================================== */

/* ç¡®ä¿æ–‡æœ¬å¯¹æ¯”åº¦ */
.text-high-contrast {
  color: var(--color-text-primary, #134E4A);
  font-weight: 500;
}

.text-medium-contrast {
  color: var(--color-text-secondary, #0F766E);
  font-weight: 400;
}

/* é“¾æ¥å¯è®¿é—®æ€§ */
a {
  color: var(--color-accent, #0D9488);
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 2px;
}

a:hover {
  color: var(--color-accent-hover, #0F766E);
  text-decoration-thickness: 2px;
}

a:focus-visible {
  background-color: var(--color-accent-subtle, #CCFBF1);
  padding: 2px 4px;
  margin: -2px -4px;
  border-radius: 4px;
}

/* ==========================================
   å±å¹•é˜…è¯»å™¨æ”¯æŒ
   ========================================== */

/* ä»…å±å¹•é˜…è¯»å™¨å¯è§ */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* å¯é€‰æ‹©æ€§æ˜¾ç¤ºç»™å±å¹•é˜…è¯»å™¨ */
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* ==========================================
   é”®ç›˜å¯¼èˆªå¢å¼º
   ========================================== */

/* é”®ç›˜å¯¼èˆªæŒ‡ç¤ºå™¨ */
.keyboard-navigation *:focus-visible {
  box-shadow:
    0 0 0 2px var(--color-bg-primary, #F0FDFA),
    0 0 0 4px var(--color-accent, #0D9488);
}

/* Tab é”®å¯¼èˆªé¡ºåºä¼˜åŒ– */
.tab-group-card:focus-within {
  border-color: var(--color-accent, #0D9488);
  box-shadow: 0 0 0 2px var(--color-accent-subtle, #CCFBF1);
}

/* ä¸‹æ‹‰èœå•é”®ç›˜å¯¼èˆª */
.dropdown-menu [role="menuitem"]:focus {
  background-color: var(--color-accent-subtle, #CCFBF1);
  color: var(--color-text-primary, #134E4A);
}

/* ==========================================
   çŠ¶æ€æŒ‡ç¤ºå™¨
   ========================================== */

/* åŠ è½½çŠ¶æ€ */
.loading[aria-busy="true"]::after {
  content: "åŠ è½½ä¸­...";
  position: absolute;
  left: -9999px;
}

/* é”™è¯¯çŠ¶æ€ */
.error[aria-invalid="true"] {
  border-color: var(--color-danger, #DC2626);
  background-color: rgba(220, 38, 38, 0.05);
}

.error[aria-invalid="true"]::after {
  content: attr(aria-describedby);
  position: absolute;
  left: -9999px;
}

/* æˆåŠŸçŠ¶æ€ */
.success[aria-live="polite"]::after {
  content: "æ“ä½œæˆåŠŸ";
  position: absolute;
  left: -9999px;
}

/* ==========================================
   é«˜å¯¹æ¯”åº¦æ¨¡å¼æ”¯æŒ
   ========================================== */

@media (prefers-contrast: high) {
  /* å¢å¼ºè¾¹æ¡†å¯¹æ¯”åº¦ */
  .card,
  .btn,
  .input,
  .tab-group-card {
    border: 2px solid var(--color-text-primary, #134E4A);
  }

  /* å¢å¼ºæ–‡æœ¬å¯¹æ¯”åº¦ */
  .text-muted {
    color: var(--color-text-secondary, #0F766E);
    font-weight: 600;
  }

  /* å¢å¼ºæŒ‰é’®å¯¹æ¯”åº¦ */
  .btn-primary {
    background-color: var(--color-text-primary, #134E4A);
    color: var(--color-bg-primary, #F0FDFA);
    border: 2px solid var(--color-text-primary, #134E4A);
  }

  .btn-secondary {
    background-color: var(--color-bg-primary, #F0FDFA);
    color: var(--color-text-primary, #134E4A);
    border: 2px solid var(--color-text-primary, #134E4A);
  }
}

/* ==========================================
   å‡å°‘åŠ¨ç”»åå¥½æ”¯æŒ
   ========================================== */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  /* ä¿ç•™é‡è¦çš„çŠ¶æ€å˜åŒ– */
  .loading-spinner {
    animation: none;
  }

  .loading-spinner::after {
    content: "åŠ è½½ä¸­...";
    display: inline-block;
  }
}

/* ==========================================
   è‰²å½©æ„ŸçŸ¥éšœç¢æ”¯æŒ
   ========================================== */

/* ä¸ºè‰²ç›²ç”¨æˆ·æ·»åŠ å›¾æ¡ˆ/å½¢çŠ¶æŒ‡ç¤ºå™¨ */
.status-success::before {
  content: "âœ“ ";
  font-weight: bold;
}

.status-warning::before {
  content: "âš  ";
  font-weight: bold;
}

.status-error::before {
  content: "âœ— ";
  font-weight: bold;
}

.status-info::before {
  content: "â„¹ ";
  font-weight: bold;
}

/* ==========================================
   å­—ä½“å¤§å°åå¥½æ”¯æŒ
   ========================================== */

/* æ”¯æŒç”¨æˆ·å­—ä½“å¤§å°åå¥½ */
@media (prefers-font-size: large) {
  html {
    font-size: 18px;
  }
}

@media (prefers-font-size: small) {
  html {
    font-size: 14px;
  }
}

/* ==========================================
   è¯­éŸ³æ§åˆ¶æ”¯æŒ
   ========================================== */

/* ä¸ºè¯­éŸ³æ§åˆ¶æ·»åŠ å¯è§æ ‡ç­¾ */
[data-voice-command]::after {
  content: attr(data-voice-command);
  position: absolute;
  left: -9999px;
}

/* ==========================================
   æ‰“å°æ ·å¼ä¼˜åŒ–
   ========================================== */

@media print {
  /* ç¡®ä¿é‡è¦å†…å®¹åœ¨æ‰“å°æ—¶å¯è§ */
  .sr-only {
    position: static;
    width: auto;
    height: auto;
    margin: 0;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }

  /* ç§»é™¤è£…é¥°æ€§å…ƒç´  */
  .btn-icon,
  .micro-interactions,
  .animation {
    display: none;
  }

  /* ç¡®ä¿é“¾æ¥åœ°å€å¯è§ */
  a[href^="http"]::after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }
}

/* ==========================================
   è¾…åŠ©åŠŸèƒ½å·¥å…·ç±»
   ========================================== */

/* é«˜å¯¹æ¯”åº¦æ–‡æœ¬ */
.a11y-high-contrast {
  color: var(--color-text-primary, #134E4A) !important;
  font-weight: 600 !important;
}

/* å¤§å­—ä½“ */
.a11y-large-text {
  font-size: 1.25em !important;
  line-height: 1.6 !important;
}

/* æ— åŠ¨ç”» */
.a11y-no-animation * {
  animation: none !important;
  transition: none !important;
}

/* é«˜å¯¹æ¯”åº¦è¾¹æ¡† */
.a11y-high-contrast-border {
  border: 2px solid var(--color-text-primary, #134E4A) !important;
}

/* ç„¦ç‚¹é™·é˜± */
.focus-trap {
  position: relative;
}

.focus-trap::before,
.focus-trap::after {
  content: '';
  position: absolute;
  width: 1px;
  height: 1px;
  opacity: 0;
  pointer-events: none;
}

/* ==========================================
   ARIA å®æ—¶åŒºåŸŸ
   ========================================== */

.live-region {
  position: absolute;
  left: -9999px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

.live-region[aria-live="polite"],
.live-region[aria-live="assertive"] {
  position: static;
  width: auto;
  height: auto;
  overflow: visible;
  padding: 8px;
  background-color: var(--color-bg-elevated, #FFFFFF);
  border: 1px solid var(--color-border-default, #A7F3D0);
  border-radius: 4px;
  margin: 8px 0;
}

/* ==========================================
   å·¥å…·æç¤ºå¯è®¿é—®æ€§
   ========================================== */

.tooltip[role="tooltip"] {
  background-color: var(--color-text-primary, #134E4A);
  color: var(--color-bg-primary, #F0FDFA);
  font-weight: 500;
  border: 1px solid var(--color-text-primary, #134E4A);
}

.tooltip[role="tooltip"]::before {
  border-color: var(--color-text-primary, #134E4A) transparent transparent transparent;
}

/* ==========================================
   è¡¨å•å¯è®¿é—®æ€§
   ========================================== */

.form-group {
  margin-bottom: 1rem;
}

.form-label {
  display: block;
  font-weight: 600;
  color: var(--color-text-primary, #134E4A);
  margin-bottom: 0.5rem;
}

.form-label[required]::after {
  content: " *";
  color: var(--color-danger, #DC2626);
}

.form-input[aria-invalid="true"] {
  border-color: var(--color-danger, #DC2626);
  background-color: rgba(220, 38, 38, 0.05);
}

.form-error {
  color: var(--color-danger, #DC2626);
  font-size: 0.875rem;
  margin-top: 0.25rem;
  font-weight: 500;
}

.form-help {
  color: var(--color-text-secondary, #0F766E);
  font-size: 0.875rem;
  margin-top: 0.25rem;
}